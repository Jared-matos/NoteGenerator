<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Static Template</title>
  </head>

  <style>
    .displayBlock {display: block;}
    .tableRow {
      display: table-row;
      font-family: calibri;
      size: 12pt;
      height: 25px;
    }
    .displayNone{ display: none;}
    .displayAsCell { display: table-cell;}
    #tDiv span {
      display: table-cell;
      font-family: calibri;
      size: 12pt;
      width: 200px;
      vertical-align: middle;
    }
    #tDiv input[type="text"] {
      display: table-cell;
      font-family: calibri;
      size: 12pt;
      width: 100%;
    }
    #tDiv {
      height: 150px;
      width: 380px;
      border-radius: 10px;
      background-color: #f2f2f2;
      padding: 10px;
    }
    #tDiv button{
      max-height: 25px;
      min-width: 0px;
      padding: 2px 2px 2px 2px;
      margin-left: 1px;
    }
  </style>

  <div id="tDiv">
    <!--Every call information-->
    <div class="tableRow">
      <span>Caller Type</span>
      <div class="displayAsCell">
        <input type="radio" id="Member" name="MP" onclick="mpRadio()" value="Member">
        <label>Member</label>
        <input type="radio" id="Provider" name="MP" onclick="mpRadio()" value="Provider">
        <label>Provider</label>
      </div>
    </div>    
    <div class="tableRow">
      <span>Caller Name</span>
      <input type="text" id="callerName" autocomplete="off" list="autocompleteOff"/>
    </div>
    <div class="tableRow">
      <span>Callback Number</span>
      <input type="text" id="callbackNumber" autocomplete="off" list="autocompleteOff"/>
    </div>
    <!--Member info Section-->
    <div class="displayNone" id="mbrLine0">
      <span>Relationship to Member</span>
      <input type="text" id="callerRel" autocomplete="off" list="autocompleteOff"/>
    </div>
    <!--Provider info section-->
    <div class="displayNone" id="provInfoBlock">
      <div class="tableRow">
        <div class="displayAsCell">
          <input type="radio" id="NPI" name="NPI/TIN" value="NPI"/>
          <label>NPI</label>
          <input type="radio" id="TIN" name="NPI/TIN" value="TIN"/>
          <label>TIN</label>
        </div>
        <input type="text" id="provIDText" autocomplete="off" list="autocompleteOff"/>
      </div>
      <div class="tableRow">
        <span>Facility Name</span>
        <input type="text" id="provNamesText" autocomplete="off" list="autocompleteOff"/>
      </div>
      <div class="tableRow">
        <span>Site Address</span>
        <input type="text" id="siteAddress" autocomplete="off" list="autocompleteOff"/>
      </div>
    </div>
    <!--all call around address confirmation-->
    <div class="tableRow">
      <span>Confirmed address on file?</span>
      <input type="checkbox" id="confirmedAddress"/>
    </div>
    <div class="displayBlock callTypeDivs" id="callTypeDiv0" onchange="callTypeSel()">
      <div class="tableRow" id="callTypeRow">
          <span>Call Type</span>
          <select id="callTypeSelect0" value="">
            <option value=""></option>
            <option value="Authorization Status">Authorization Status</option>
            <option value="Benefit Information">Benefits</option>
            <option value="Claim Information">Claim Information</option>
            <option value="Eligibility">Eligibility Status</option>
            <option value="Referral Request">Referrals</option>
          </select>
          <button type="button" id="cloneCallTypeDivButton" onclick="cloneCallType()">+</button>
          <button type="button" id="removeCallTypeDivButton0" onclick="removeCallType(this)">x</button>
      </div>
      <div class="displayNone callTypeHidden" id="callTypeBlock0">
        <div class="tableRow">
          <span>Auth information given</span>
          <input type="text" id="callTypeInput0" autocomplete="off" list="autocompleteOff"/>
        </div>
      </div>
      <div class="displayNone callTypeHidden" id="callTypeBlock1">
        <div class="tableRow">
          <span>Benefit information given</span>
          <input type="text" id="callTypeInput1" autocomplete="off" list="autocompleteOff"/>
        </div>
      </div>
      <div class="displayNone callTypeHidden" id="callTypeBlock2">
        <div class="tableRow">
          <span>Claim information given</span>
          <input type="text" id="callTypeInput2" autocomplete="off" list="autocompleteOff"/>
        </div>
      </div>
      <div class="displayNone callTypeHidden" id="callTypeBlock3">
        <div class="tableRow">
          <span>Eligibility information given</span>
          <input type="text" id="callTypeInput3" autocomplete="off" list="autocompleteOff"/>
        </div>
      </div>
      <div class="displayNone callTypeHidden" id="callTypeBlock4">
        <div class="tableRow">
          <span>Referral information given</span>
          <input type="text" id="callTypeInput4" autocomplete="off" list="autocompleteOff"/>
        </div>
      </div>
    </div>
    
    <!--Member Specific situations-->
    <div class="displayNone" id="mbrEnd">
      <div class="tableRow">
        <span>Member Satisfied?</span>
        <input type="checkbox" id="mbrSatasfied" onclick="msCheck()" />
      </div>
      <div class="displayBlock" id="mbrNSatasfied">
        <div class="tableRow">
          <span>Grievance offered?</span>
          <input type="checkbox" id="grievanceOffered"/>
        </div>
        <div class="tableRow">
          <span>Grievance Filed?</span>
          <input type="checkbox" id="grievanceFiled"/>
        </div>
      </div>
    </div>
    <!--Button at bottom of form -->
    <div class="tableRow">
      <textarea readonly type="text" class="displayNone" id="oText"></textarea>
      <button type="button" onclick="copyClipboard()">Copy to Clipboard</button>
      <button type="button" onclick="clearAll()">Clear All</button>
      <!--<button type="button" onclick="openNewWindow()">New Window</button>-->
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
  <script type="text/javascript">
    console.clear();
    console.log('script run');
    var callTypeArray = [0];
    changeHeight();

    /*function openNewWindow(){
      var divText = document.getElementById("tDiv").outerHTML;
      var myWindow = window.open('', '', 'width=200,height=100');
      var doc = myWindow.document;
      doc.open();
      doc.write(divText);
      doc.close();
    }*/
    
    // removes the current call type of the button that has been selected 
    function removeCallType(button) {
      var callerNum = button.id.slice(button.id.length - 1, button.id.length);
      if (callTypeArray.length > 1) {
        document.getElementById('callTypeDiv' + callerNum).remove();
        var index = callTypeArray.indexOf(parseInt(callerNum));
        callTypeArray.splice(index,1);
      }
      callTypeSel();
    }

    // creates clones of the callType div and changes the names of the clones children
    function cloneCallType(){
      var parent = document.getElementById('callTypeDiv'+callTypeArray[0]);
      var clone = parent.cloneNode(true);
      callTypeArray.push(callTypeArray[callTypeArray.length-1]+1);
      clone.id = "callTypeDiv" + callTypeArray[callTypeArray.length-1];
      clone.getElementsByTagName('select')[0].id = "callTypeSelect" + callTypeArray[callTypeArray.length-1];
      clone.getElementsByTagName('select')[0].value = "";
      clone.getElementsByTagName('button')[1].id = "removeCallTypeDivButton" + callTypeArray[callTypeArray.length-1];
      for(i = 0; i < 5; i++){
        clone.getElementsByTagName('input')[i].id = "callTypeInput" + i + callTypeArray[callTypeArray.length-1];
        clone.getElementsByTagName('input')[i].value = "";
        var elements = clone.getElementsByClassName('callTypeHidden');
        if(elements.item(i) === null){
          alert("Error Occured, Reloading page. Please save information");
          location.reload();
        }else { 
          elements.item(i).id = "callTypeBlock" + i + callTypeArray[callTypeArray.length-1];
          //console.log('Created:', elements.item(i).id);
        }
      }
      document.getElementById('callTypeDiv'+(callTypeArray[callTypeArray.length-1]-1)).after(clone);
      callTypeSel();
    }

    // toggles member satasfied field open and closed 
    function msCheck(){
      if (document.getElementById("mbrSatasfied").checked == true){
        document.getElementById("mbrNSatasfied").className = "displayNone";
        changeHeight();
      } else {
        document.getElementById("mbrNSatasfied").className = "displayBlock";
        changeHeight();
      }
    }

    // toggles between member and provider fields
    function mpRadio(){
      if (document.getElementById("Member").checked == false){
        document.getElementById("mbrLine0").className = "displayNone";
        document.getElementById("mbrEnd").className = "displayNone";
        document.getElementById("provInfoBlock").className = "displayBlock";
        changeHeight();
      } else {
        document.getElementById("mbrLine0").className = "tableRow";
        document.getElementById("mbrEnd").className = "displayBlock";
        document.getElementById("provInfoBlock").className = "displayNone";
        changeHeight();
      }
    }
    
    // goes through each selectBox and if it has a value changes the classname of the correct div to displayBlock setting all other children of selectbox classes as displayNone and callTypeHidden
    function callTypeSel() {
      var divs = document.getElementsByClassName('callTypeDivs');
      for (i = 0; i < divs.length; i++) {
        var blocks = divs.item(i).getElementsByClassName('callTypeHidden');
        for(y = 0; y < blocks.length; y++) {
          blocks.item(y).className = 'displayNone callTypeHidden';
        }
        switch (divs.item(i).getElementsByTagName('select')[0].value) {
          case 'Authorization Status':
            divs.item(i).getElementsByClassName('callTypeHidden').item(0).className = 'displayBlock callTypeHidden';
            break;
          case 'Benefit Information':
            divs.item(i).getElementsByClassName('callTypeHidden').item(1).className = 'displayBlock callTypeHidden';
            break;
          case 'Claim Information':
            divs.item(i).getElementsByClassName('callTypeHidden').item(2).className = 'displayBlock callTypeHidden';
            break;
          case 'Eligibility':
            divs.item(i).getElementsByClassName('callTypeHidden').item(3).className = 'displayBlock callTypeHidden';
            break;
          case 'Referral Request':
            divs.item(i).getElementsByClassName('callTypeHidden').item(4).className = 'displayBlock callTypeHidden';
            break;
          default:
            break;
        }
      }
      changeHeight();
    }

    //sets height of tDiv to standard height for the number of visible rows 
    function changeHeight(){
      var currentHeightInt = 25 * ($(".tableRow:visible").length);
      var currentHeightStr = currentHeightInt.toString();
      currentHeightStr = currentHeightStr.concat("px");
      document.getElementById("tDiv").style.height = currentHeightStr;
    }

    //Sets vaules of all fields to empty or false
    function clearAll() {
      document.getElementById("callerName").value = "";
      document.getElementById("callbackNumber").value = "";
      document.getElementById("callerRel").value = "";
      document.getElementById("provIDText").value = "";
      document.getElementById("provNamesText").value = "";
      document.getElementById("siteAddress").value = "";
      document.getElementById("mbrSatasfied").checked = false;
      document.getElementById("mbrNSatasfied").checked = false;
      document.getElementById("grievanceOffered").checked = false;
      document.getElementById("grievanceFiled").checked = false;
      document.getElementById("confirmedAddress").checked = false;
      document.getElementById("NPI").checked = false;
      document.getElementById("TIN").checked = false;
      document.getElementById("Member").checked = false;
      document.getElementById("Provider").checked = false;
      //document.getElementById("callTypeSelect0").value = "";
      document.getElementById("provInfoBlock").className = "displayNone";
      document.getElementById("mbrLine0").className = "displayNone";
      document.getElementById("mbrEnd").className = "displayNone";
      document.getElementById("mbrNSatasfied").className = "displayBlock";


      while(callTypeArray.length !== 1) {
        document.getElementById("callTypeDiv"+callTypeArray[callTypeArray.length-1]).remove();
        callTypeArray.splice(callTypeArray.length-1,1);
      }
      document.getElementById("callTypeSelect" + callTypeArray[0]).value = '';
      for (y = 0; y <= 4; y++) {
        if (callTypeArray[0] == 0) {
          document.getElementById("callTypeInput" + y).value = '';
        } else {
          document.getElementById("callTypeInput" + y + callTypeArray[0]).value = '';
        }
      }
      callTypeSel();
    }

    // Collects the information from the fields, combines them into an output string, and sends to the clipboard
    function copyClipboard() {
      // collecting information from all the fields & generating output and error texts
      var CALLERNAME = document.getElementById("callerName").value;
      var CBNUM = document.getElementById("callbackNumber").value;
      var CALLERREL = document.getElementById("callerRel").value;
      var PROVID = document.getElementById("provIDText").value;
      var PROVNAME = document.getElementById("provNamesText").value;
      var SITEADD = document.getElementById("siteAddress").value;
      var CNFADD = document.getElementById("confirmedAddress").checked;
      var NPICHK = document.getElementById("NPI").checked;
      var TINCHK = document.getElementById("TIN").checked;
      var MBRCHK = document.getElementById("Member").checked;
      var PROVCHK = document.getElementById("Provider").checked;
      var MBRSAT = document.getElementById("mbrSatasfied").checked;
      var GOFF = document.getElementById("grievanceOffered").checked;
      var GFILED = document.getElementById("grievanceFiled").checked;
      var outputText = "";
      
      // combining all the data into a single string, any empty required fields are added to error text
      if (CALLERNAME !== "") {outputText = outputText.concat(CALLERNAME," / ");}
      if (CALLERREL !== "" && MBRCHK == true) {outputText = outputText.concat(CALLERREL," / ");}
      if (CBNUM !== "") {outputText = outputText.concat("CB# ",CBNUM," / ");}
      if (NPICHK == true && PROVCHK == true) {outputText = outputText.concat("NPI: ",PROVID);}
      if (TINCHK == true && PROVCHK == true) {outputText = outputText.concat("TIN: ",PROVID);}
      if (SITEADD !== "" && PROVCHK == true) {outputText = outputText.concat(" - ",SITEADD," / ");}
      if (CNFADD == true) {outputText = outputText.concat("Confirmed Address on file / ");} 
      else if (outputText !== "") {outputText = outputText.concat("Unable to confirm address on file / ");}

      if(document.getElementById('callTypeSelect'+callTypeArray[0]).value !== '') {
        for(i = 0; i < callTypeArray.length; i++) {
          console.log(i);
          outputText = outputText.concat('Reason for call: '+document.getElementById("callTypeSelect"+callTypeArray[i]).value + " / ");
          for(y = 0; y <= 4; y++) {
            if(callTypeArray[i]==0) {
              outputText = outputText.concat(document.getElementById("callTypeInput"+y).value);
            } else { 
              outputText = outputText.concat(document.getElementById("callTypeInput"+y+callTypeArray[i]).value);
            }
          }
          outputText = outputText.concat(" / ");
        } 
      }

      if (MBRCHK == true) {
        if (MBRSAT == true) {outputText = outputText.concat("Member satisfied");} 
        else if (outputText !== "") {outputText = outputText.concat("Member unsatisfied / ");
          if (GOFF == true) {outputText = outputText.concat("Grievance was offered / ");}
          else if (outputText !== "") {outputText = outputText.concat("Grievance was not offered / ");}
          if (GFILED == true) {outputText = outputText.concat("Grievance was filed");}
          else if (outputText !== "") {outputText = outputText.concat("Grievance was not filed");}
        }
      }
      // displays the output text box momentarily and fills it with the output text
      document.getElementById("oText").style.display = "block";
      document.getElementById("oText").value = outputText;
      // select and copy the information in the output text box, then hides the information again
      var copyTextarea = document.getElementById("oText");
      copyTextarea.focus();
      copyTextarea.select();
      try {document.execCommand("copy");} 
      catch (err) {alert("Oops, unable to copy");}
      document.getElementById("oText").style.display = "none";
      console.log(outputText)
    }
  </script>
  <!--Code hosted on Github @ https://github.com/Jared-matos/NoteGenerator-->

  <!--Remove closing tags when importing to SharePoint-->
</html>